/*
main
version:1.0.0
build:2017-04-27 15:22:43
*/
!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var i=n(1);window.Video3D=i.Video3D,window.MouseControl=i.MouseControl,window.OrientationControl=i.OrientationControl},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e),this.running=!1,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.zIndex=1,t.appendChild(this.renderer.domElement)}return i(e,[{key:"play",value:function(e){this.video=e,this.reset(),this.running=!0;var t=this,n=function e(){t.running&&requestAnimationFrame(e),t.renderer.clear(),t.renderer.render(t.scene,t.camera)};n()}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.reset()}},{key:"stop",value:function(e){this.running=!1;var t=this.renderer.domElement;e&&null!=t.parentNode&&t.parentNode.removeChild(t)}},{key:"reset",value:function(){if(null!=this.video&&!isNaN(this.width)&&!isNaN(this.height)){this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(60,this.width/this.height,1,1e3),this.camera.lookAt({x:0,y:0,z:0});var e=new THREE.VideoTexture(this.video);e.minFilter=THREE.LinearFilter,e.format=THREE.RGBFormat;var t=new THREE.MeshBasicMaterial({map:e}),n=new THREE.SphereBufferGeometry(this.width/2,this.width/10,this.height/10);n.scale(-1,1,1),this.sphere=new THREE.Mesh(n,t),this.scene.add(this.sphere),this.renderer.setSize(this.width,this.height)}}}]),e}(),o=function(e){return Math.max(Math.min(90*Math.PI/180,e),-90*Math.PI/180)},a=function(e){try{var t=0,n=0,i=document.documentElement,r=document.body;if(e||(e=window.event),window.pageYOffset?(t=window.pageXOffset,n=window.pageYOffset):(t=(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),n=(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.changedTouches){var o=e.changedTouches[0];t=o.pageX,n=o.pageY}else t+=e.clientX,n+=e.clientY;return{x:t,y:n}}catch(e){return null}},s=function e(t,i){n(this,e);var r=void 0,s=function(e){var t=a(e),n=i.sphere;n.rotation.y-=(t.x-r.x)/width*2,n.rotation.x=o(n.rotation.x-(t.y-r.y)/height*2),r=t},h=function e(t){document.removeEventListener("mouseup",e,!1),document.removeEventListener("mousemove",s,!1)},d=function(e){r=a(e),document.addEventListener("mouseup",h,!1),document.addEventListener("mousemove",s,!1)};t.addEventListener("mousedown",d,!1)},h=function e(t){var i=this;n(this,e),t.camera.rotation.reorder("YXZ"),this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var r=function(e){i.deviceOrientation=e,i.update()},o=function(){i.screenOrientation=window.orientation||0},a=function(){var e=new THREE.Vector3(0,0,1),t=new THREE.Euler,n=new THREE.Quaternion,i=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(r,o,a,s,h){t.set(a,o,-s,"YXZ"),r.setFromEuler(t),r.multiply(i),r.multiply(n.setFromAxisAngle(e,-h))}}();this.update=function(){var e=this.deviceOrientation.alpha?THREE.Math.degToRad(this.deviceOrientation.alpha)+this.alphaOffsetAngle:0,n=this.deviceOrientation.beta?THREE.Math.degToRad(this.deviceOrientation.beta):0,i=this.deviceOrientation.gamma?THREE.Math.degToRad(this.deviceOrientation.gamma):0,r=this.screenOrientation?THREE.Math.degToRad(this.screenOrientation):0;a(t.camera.quaternion,e,n,i,r),this.alpha=e},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},o(),window.addEventListener("orientationchange",o,!1),window.addEventListener("deviceorientation",r,!1)};t.Video3D=r,t.MouseControl=s,t.OrientationControl=h}]);